# Gemini 3.1 Pro - no_guidelines Run Analysis

## Run Metadata

- **Run ID:** jn71vqv2epgd3ybaz4g1xckjv181g9d3
- **Model:** google/gemini-3.1-pro-preview
- **Experiment:** no_guidelines
- **Date:** 2026-02-20
- **Pass rate:** 36/66 (55%) - vs top-of-leaderboard performance with guidelines

## Failure Summary

| Step | Count |
|---|---|
| tsc | 22 |
| deploy | 7 |
| eslint | 1 |
| **Total** | **30** |

## Root Cause Analysis

Two root causes account for nearly all 30 failures:

### Root Cause 1: `src/App.tsx` hallucination (~22 tsc failures)

The dominant pattern. For backend-only tasks (schema, queries, mutations, etc.), the model spontaneously creates `src/App.tsx` containing a trivial JSX placeholder like:

```tsx
export default function App() {
  return <div>Customer Stats Backend - Hello World</div>;
}
```

The eval scaffold has no React dependency installed, so tsc fails with:
```
src/App.tsx: error TS7026: JSX element implicitly has type 'any' because no interface 'JSX.IntrinsicElements' exists
src/App.tsx: error TS2875: This JSX tag requires 'react/jsx-runtime' to exist but none could be found
```

Crucially, the **Convex backend code itself is correct** in these cases - schema, queries, and mutations all match the expected answer. The failure is entirely caused by the uninstructed, out-of-scope frontend file.

This behavior is consistent with other models in no_guidelines runs (also seen in MiniMax M2.5 analysis). With guidelines, models receive explicit instruction to restrict output to `convex/` and requested files, which prevents this entirely.

**Affected evals (confirmed):**
- 000-fundamentals/001-basic_schema
- 000-fundamentals/006-database_crud
- 002-queries/007-aggregation
- And likely the majority of the remaining 19 tsc failures

### Root Cause 2: Convex API misuse (~7 deploy failures)

Without guidelines explaining the correct Convex API patterns, the model applies generic TypeScript/framework assumptions:

**Example 1 - function_calling (deploy fail):** Calls internal functions directly instead of via `ctx.runQuery`/`ctx.runMutation`:
```typescript
// Model wrote (incorrect):
const result = await calleeQuery(ctx, { x: 1, y: 2 });

// Expected:
const result = await ctx.runQuery(internal.index.calleeQuery, { x: 1, y: 2 });
```

**Example 2 - crons (deploy fail):** Omits required `{}` args for `crons.interval` when no args needed:
```typescript
// Model wrote (incorrect - 3 args):
crons.interval("run every second", { seconds: 1 }, internal.crons.emptyAction);

// Expected (4 args, empty object required):
crons.interval("run every second", { seconds: 1 }, internal.crons.emptyAction, {});
```

These are pure knowledge-gap failures - the model has no way to know the correct Convex API without guidelines or training data. Guidelines directly supply this knowledge.

### Root Cause 3: Known lint gap (1 eslint failure)

- **006-clients/001-use_mutation** - `@typescript-eslint/no-misused-promises` on async form handler. Documented in GAPS.txt. The reference answer has the same pattern and would fail the same lint. Minor additional model fault: `React` used without import (`no-undef`).

## Per-Failure Classification Table

| Eval | Step | Classification | Notes |
|---|---|---|---|
| 000-fundamentals/001-basic_schema | tsc | MODEL_FAULT | App.tsx hallucination; backend correct |
| 000-fundamentals/002-basic_http_endpoint | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 000-fundamentals/003-crons | deploy | MODEL_FAULT | Missing `{}` args on crons.interval |
| 000-fundamentals/004-scheduler | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 000-fundamentals/005-function_calling | deploy | MODEL_FAULT | Incorrect ctx.runQuery API usage |
| 000-fundamentals/006-database_crud | tsc | MODEL_FAULT | App.tsx hallucination; backend correct |
| 000-fundamentals/007-basic_file_storage | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 000-fundamentals/008-helper_fns | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 000-fundamentals/009-returns_validator | deploy | MODEL_FAULT | API misuse (inferred) |
| 001-data_modeling/007-schema_evolution | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 001-data_modeling/008-nullable_partial | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 001-data_modeling/010-discriminated_union | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 001-data_modeling/012-denormalize_for_index | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/004-range_condition | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/007-aggregation | tsc | MODEL_FAULT | App.tsx hallucination; backend correct |
| 002-queries/009-text_search | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/010-parallel_fetch | deploy | MODEL_FAULT | API misuse (inferred) |
| 002-queries/012-index_and_filter | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/013-async_iterator_filter | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/015-pagination | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/017-pagination_join | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/018-pagination_returns_validator | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/019-no_scheduler | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 002-queries/020-text_search_join | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 003-mutations/001-insert | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 003-mutations/005-cascade_delete_nested | deploy | MODEL_FAULT | API misuse (inferred) |
| 003-mutations/006-no_storage | deploy | MODEL_FAULT | API misuse (inferred) |
| 004-actions/005-storage_http_action | deploy | MODEL_FAULT | API misuse (inferred) |
| 005-idioms/002-batch_queries | tsc | MODEL_FAULT | App.tsx hallucination (inferred) |
| 006-clients/001-use_mutation | eslint | KNOWN_GAP | Documented no-misused-promises gap; minor React import miss |

## Cross-Cutting Patterns

1. **The no_guidelines delta is explained, not surprising.** Gemini 3.1 Pro leads the leaderboard with guidelines because it's an excellent model that responds well to structured instruction. Without guidelines, it falls back to generic "full-stack app" behavior (adding `src/App.tsx`) and guesses at Convex-specific API patterns it has limited training data for. This is the experiment working as designed.

2. **App.tsx hallucination is a shared model behaviour, not a Gemini-specific bug.** The same pattern is seen in MiniMax M2.5 and likely others. The fix is in guidelines (file-scope restriction), not in tasks.

3. **API misuse failures are direct knowledge-gap failures.** `ctx.runQuery`, `crons.interval` arity, and similar patterns are Convex-specific and not learnable without either training data or guidelines. These would likely persist even with clearer task descriptions.

4. **No eval quality issues found.** All sampled failures are genuine model faults or known gaps. No tasks are ambiguous or overly strict in a way that explains the failures.

## Recommendations

### No action needed (eval/task quality is fine)
All 30 failures are correctly classified as either MODEL_FAULT or KNOWN_GAP. The tasks, tests, and lint rules are reasonable. The no_guidelines score accurately reflects what happens when a capable model lacks Convex-specific API knowledge.

### Potential future improvement
The `src/App.tsx` pattern has now been observed in multiple models. If we wanted to reduce noise in no_guidelines runs, we could add a `package.json` that fails loudly on unknown file writes - but this would change the experiment semantics. Better to leave it as-is; it's a valid signal.

### Known gap (pre-existing)
- **006-clients/001-use_mutation eslint** - GAPS.txt already documents the `@typescript-eslint/no-misused-promises` lint issue. No new action needed.

## Net Impact Assessment

- 29/30 failures: genuine MODEL_FAULT (correct behavior for no_guidelines experiment)
- 1/30 failure: KNOWN_GAP (pre-existing, documented)
- 0/30 failures: eval quality issues requiring fixes

**The no_guidelines score (55%) vs with-guidelines (top of leaderboard) delta is expected and correct.** Gemini 3.1 Pro is an excellent model that genuinely needs Convex guidelines to produce correct Convex code.
